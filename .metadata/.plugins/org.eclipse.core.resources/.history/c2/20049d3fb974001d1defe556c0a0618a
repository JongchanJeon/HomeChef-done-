package FinalProject.action;

import java.util.Enumeration;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.oreilly.servlet.MultipartRequest;
import com.oreilly.servlet.multipart.DefaultFileRenamePolicy;

import FinalProject.controller.Action;
import FinalProject.controller.ActionForward;
import FinalProject.model.DAO;
import FinalProject.model.DTO;

public class insertItemAction implements Action {

	@Override
	public ActionForward execute(HttpServletRequest request, HttpServletResponse response) throws Exception {
		request.setCharacterEncoding("utf-8");
		DAO dao = new DAO();
		DTO dto = new DTO();
		
		String imgDirPath = "C:\\Users\\jjc63\\Desktop\\finalProject\\FinalProject\\src\\main\\webapp\\com\\yju\\2wda\\2101198\\controller\\image\\";
		int maxSize = 1024 * 1024 * 5;
		
		MultipartRequest multi = new MultipartRequest(request,
														imgDirPath,
														maxSize,
														"utf-8",
														new DefaultFileRenamePolicy());
//		db 생성 
//		CREATE TABLE product (
//				product_id INT PRIMARY KEY AUTO_INCREMENT,
//				product_name VARCHAR(30) NOT NULL,
//				product_originalName VARCHAR(30) NOT NULL,
//				product_file_type VARCHAR(30) NOT NULL,
//				product_file_size Int,
//				product_price INT NOT NULL,
//				product_image VARCHAR(100) NOT NULL,
//				product_description VARCHAR(1024) NOT NULL
//			);
		String product_name = multi.getParameter("product_name");
		int product_price = Integer.parseInt(multi.getParameter("product_price"));
		String product_description = multi.getParameter("product_description");
		
		Enumeration<?> files = multi.getFileNames();
		
		String element= "";
		String filesystemName = "";
		String originalFileName = "";
		String contentType = "";
		long length = 0;
		
		if (files.hasMoreElements()) {
			element = (String)files.nextElement();
			
			filesystemName = multi.getFilesystemName(element);
			originalFileName = multi.getOriginalFileName(element);
			contentType = multi.getContentType(element);
			length = multi.getFile(element).length();
		}
		return null;
	}

}
